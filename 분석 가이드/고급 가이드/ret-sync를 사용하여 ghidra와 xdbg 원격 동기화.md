▸ret-sync

▸ghidra에 ret-sync 설치

▸xdbg에 ret-sync 설치

▸ghidra와 xdbg의 원격 동기화

---

# ▸ret-sync

https://github.com/bootleg/ret-sync

- ret-sync를 사용하면, ghidra와 xdbg를 연동 가능

# ▸ghidra에 ret-sync 설치

1. 다운받은 ret-sync에서 미리 build되어 있는 ret-sync 확인 ⇒ 해당 버전의 ghidra가 필요
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160206322.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160206322.png)
    
2. File>Install Extensions..에서 +버튼을 눌러 빌드되어 있는 ret-sync를 추가 후 재시작
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160206415.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160206415.png)
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160208503.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160208503.png)
    
3. 분석하고자 하는 파일을 import 후 CodeBrowser를 실행하면 ret-sync 플러그인 확인 가능
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160208569.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160208569.png)
    
4. 원격 동기화를 위해 ghidra가 실행 중인 VM의 ip 주소 확인
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160212022.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160212022.png)
    
5. `C:\Users\(사용자계정)\` 디렉토리에 .sync 파일 설정
    
    ```C++
    [INTERFACE]
    host=192.168.56.104 // ghidra VM 주소
    port=9234
    ```
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160212084.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160212084.png)
    

- 제대로 설정했다면 다음과 같이 표기됨
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160214449.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160214449.png)
    

# ▸xdbg에 ret-sync 설치

1. asure pipline에서 사전에 빌드된 xdbg용 ret-sync 플러그인 다운로드
    
    > [!info]  
    >  
    > [https://dev.azure.com/bootlegdev/ret-sync-release/_build/results?buildId=109&view=results](https://dev.azure.com/bootlegdev/ret-sync-release/_build/results?buildId=109&view=results)  
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160216157.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160216157.png)
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160216221.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160216221.png)
    
2. 압축을 풀고 xdbg의 plugins 폴더에 저장
    
    - x32dbg = `(xdbg 설치 폴더)\release\x32\plugins`
    - x64dbg = `(xdbg 설치 폴더)\release\x64\plugins`
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160217806.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160217806.png)
    
3. xdbg를 실행하면 plugin 확인 가능
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160219097.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160219097.png)
    
4. 원격 동기화를 위해 xdbg가 실행 중인 VM의 ip 주소 확인
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160219169.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160219169.png)
    
5. `C:\Users\(사용자계정)\` 디렉토리에 .sync 파일 설정
    
    ```C++
    [INTERFACE]
    host=192.168.56.104 // ghidra VM 주소
    port=9234
    ```
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160220421.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160220421.png)
    
      
    

# ▸ghidra와 xdbg의 원격 동기화

> [!important]  
> ghidra와 xdbg는 동일한 파일을 디버깅하고 있어야 함  

1. ghidra에서 Alt+s를 통해 원격 서버 시작
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160220485.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160220485.png)
    
2. !sync 명령어를 통해 ghidra와 원격 동기화
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160221492.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160221492.png)
    
3. 다음과 같이 동기화 확인 가능
    
    ![IMG-ret-sync를 사용하여 ghidra와 xdbg 원격 동기화-20240818160221550.png](images/ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화/IMG-ret-sync를%20사용하여%20ghidra와%20xdbg%20원격%20동기화-20240818160221550.png)