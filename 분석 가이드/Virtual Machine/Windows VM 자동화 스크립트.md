## 실행 스크립트

### set_vm.ps1
 
```PowerShell
Import-Module $PSScriptRoot/modules/remove_basic_windows_app.psm1
Import-Module $PSScriptRoot/modules/set_windows_config.psm1
Import-Module $PSScriptRoot/modules/get_tools.psm1

Test_WebConnection "google.com"

Remove_Tasks
Remove_Apps
Disable_Defender
Disable_Update
Set_Taskbar
Set_Explorer
$layoutPath = Join-Path -Path $PSScriptRoot -ChildPath "start_menu_layout.xml"
Set_Startmenu $layoutPath
Disable_Firewall
Remove_Startup
Set_KR_Time

Stop-Process -Name explorer -Force
Start-Sleep -s 3

$toolData = Get-Content -Path (Join-Path -Path $PSScriptRoot -ChildPath "tools.json") -Raw | ConvertFrom-Json

$donwloadPath = $PSScriptRoot
foreach ($toolInfo in $toolData) {
	Download_Tools $toolInfo $donwloadPath
}
```

- PS 스크립트를 실행하기 위해서는 해당 폴더에서 스크립트 실행 제한을 풀어주어야 함

```PowerShell
Set-ExecutionPolicy Unrestricted -Force
```


## 윈도우 기본 앱들을 삭제하는 스크립트

### remove_basic_windows_app.psm1

```PowerShell
function Remove_Apps
{
	$packages = @(
		"Microsoft.3DBuilder",
		"Microsoft.WindowsAlarms",
		"*Autodesk*",
		"Microsoft.BingFinance",
		"Microsoft.BingNews",
		"Microsoft.BingSports",
		"Microsoft.BingWeather",
		"*BubbleWitch*",
		"king.com.CandyCrush*",
		"Microsoft.CommsPhone",
		"*Dell*",
		"*Dropbox*",
		"*Facebook*",
		"Microsoft.WindowsFeedbackHub",
		"Microsoft.Getstarted",
		"*Keeper*",
		"microsoft.windowscommunicationsapps",
		"Microsoft.WindowsMaps",
		"*MarchofEmpires*",
		"Microsoft.Messaging",
		"*Minecraft*",
		"*Netflix*",
		"Microsoft.MicrosoftOfficeHub",
		"Microsoft.OneConnect",
		"Microsoft.Office.OneNote",
		"Microsoft.People",
		"Microsoft.WindowsPhone",
		"*Plex*",
		"Microsoft.SkypeApp",
		"Microsoft.WindowsSoundRecorder",
		"*Solitaire*",
		"Microsoft.MicrosoftStickyNotes",
		"Microsoft.Office.Sway",
		"*Twitter*",
		"Microsoft.XboxApp",
		"Microsoft.XboxIdentityProvider",
		"Microsoft.ZuneMusic",
		"Microsoft.ZuneVideo",
		"*DisneyMagicKingdom*",
		"*HiddenCityMysteryofShadows*",
		"Microsoft.Microsoft3DViewer",
		"*Microsoft.WindowsCamera*",
		"*Microsoft.Wallet*",
		"*Microsoft.Windows.Photos*",
		"*Microsoft.Print3D*",
		"*Microsoft.YourPhone*",
		"*Microsoft.Wallet*",
		"*Microsoft.ScreenSketch*",
		"*Microsoft.Print3D*",
		"Microsoft.MixedReality.Portal",
		"Microsoft.BingNews",
		"*Todos*",
		"*Microsoft.Whiteboard*",
		"*sway*",
		"*Microsoft.RemoteDesktop*",
		"*Microsoft.GetHelp*",
		"*Microsoft.MSPaint*",
		"*Clipchamp*"
	)

	Write-Host "[+] Remove Basic Packages" -ForegroundColor Green
	foreach($package in $packages) {
		Write-Host "`t[+] Remove Package ($package)"
		Get-AppxPackage $package | Remove-AppxPackage
	}

	Write-Host "[+] Remove Provisioned Packages" -ForegroundColor Green
	$packages = Get-ProvisionedAppxPackage -Online | Where-Object { $_.PackageName -match "xbox" }
	ForEach ($package in $packages) {
		Write-Host "`t[+] Remove Package ($($package.PackageName))"
		Remove-ProvisionedAppxPackage -Online -AllUsers -PackageName $package.PackageName | Out-Null
	}

	# remove onedrive
	Write-Host "[+] Remove Package (onedrive)" -ForegroundColor Green
	Stop-Process -Name "OneDrive" -Force
	if((Get-WmiObject Win32_OperatingSystem | Select osarchitecture).osarchitecture -like "64*") {
		& "$env:systemroot\SysWOW64\OneDriveSetup.exe" /uninstall
	}
	else {
		& "$env:systemroot\System32\OneDriveSetup.exe" /uninstall
	}
}

Export-ModuleMember -Function Remove_Apps
```
        
- 아래 명령어를 통해 어떤 패키지들이 설치되어 있는지 확인 가능
    
```PowerShell
Get-AppxPackage -AllUsers | Select Name
```
    

## 윈도우 환경 설정

### set_windows_config.psm1

```PowerShell
function Disable_Defender {
    Write-Host -Object "[+] Disable_Defender" -ForegroundColor Green
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name "DisableAntiSpyware" -Value 1 -Force | Out-Null
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name "DisableRoutinelyTakingAction" -Value 1 -Force | Out-Null
    New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name "Spynet" -Force -ea 0 | Out-Null
    New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" -Name "SpyNetReporting" -Value 0 -PropertyType DWORD -Force -ea 0 | Out-Null
    New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" -Name "SubmitSamplesConsent" -Value 0 -PropertyType DWORD -Force -ea 0 | Out-Null
    New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft" -Name "MRT" -Force -ea 0 | Out-Null
    New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\MRT" -Name "DontReportInfectionInformation" -Value 1 -PropertyType DWORD -Force -ea 0 | Out-Null
    if(-Not ((Get-WmiObject -Class Win32_OperatingSystem).Version -eq "6.1.7601")) {
        Add-MpPreference -ExclusionPath "C:\" -Force -ea 0 | Out-Null
        Set-MpPreference -DisableArchiveScanning $true  -ea 0 | Out-Null
        Set-MpPreference -DisableBehaviorMonitoring $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableBlockAtFirstSeen $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableCatchupFullScan $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableCatchupQuickScan $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableIntrusionPreventionSystem $true  -Force -ea 0 | Out-Null
        Set-MpPreference -DisableIOAVProtection $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableRealtimeMonitoring $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableRemovableDriveScanning $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableRestorePoint $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableScanningMappedNetworkDrivesForFullScan $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableScanningNetworkFiles $true -Force -ea 0 | Out-Null
        Set-MpPreference -DisableScriptScanning $true -Force -ea 0 | Out-Null
        Set-MpPreference -EnableControlledFolderAccess Disabled -Force -ea 0 | Out-Null
        Set-MpPreference -EnableNetworkProtection AuditMode -Force -ea 0 | Out-Null
        Set-MpPreference -MAPSReporting Disabled -Force -ea 0 | Out-Null
        Set-MpPreference -SubmitSamplesConsent NeverSend -Force -ea 0 | Out-Null
        Set-MpPreference -PUAProtection Disabled -Force -ea 0 | Out-Null    
    }
}

  
  

function Disable_Update {
    Write-Host -Object "[+] Disable_Update" -ForegroundColor Green
    New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows" -Name "WindowsUpdate" -ea 0 | Out-Null
    New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate" -Name "AU" -ea 0 | Out-Null
    New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -Name "NoAutoUpdate" -Value 1 -Force | Out-Null
}

  

function Disable_Firewall {
    Write-Host -Object "[+] Disable_Firewall" -ForegroundColor Green
    Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False
}

  

function Set_Explorer {
    Write-Host -Object "[+] Set_Explorer" -ForegroundColor Green
    Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "Hidden" -Value 1 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowSuperHidden" -Value 1 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "HideFileExt" -Value 0 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState" -Name "FullPath" -Value 1 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState" -Name "FullPathAddress" -Value 1 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "LaunchTo" -Value 1 -Force | Out-Null
}

  

function Set_Taskbar {
    function Unpin-App([string]$appname) {
        ((New-Object -Com Shell.Application).NameSpace('shell:::{4234d49b-0245-4df3-b780-3893943456e1}').Items() |
            ?{$_.Name -eq $appname}).Verbs() | ?{$_.Name.replace('&','') -match 'Unpin from taskbar'} | %{$_.DoIt()}
    }
    Write-Host -Object "[+] Set_Taskbar" -ForegroundColor Green
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Search" -Name "SearchboxTaskbarMode" -Value 0 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowTaskViewButton" -Value 0 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowCortanaButton" -Value 0 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\Software\Policies\Microsoft\Windows\Explorer" -Name "HidePeopleBar" -Value 0 -Force | Out-Null
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\MultiTaskingView\AllUpView" -Name "Enabled" -Value 0 -Force | Out-Null
    Unpin-App("Microsoft Edge")
}

  

function Set_Startmenu {
    param (
        [string]$layoutFile
    )
    Write-Host -Object "[+] Set_Startmenu" -ForegroundColor Green
    $regAliases = @("HKLM", "HKCU")
    
    #Assign the start layout and force it to apply with "LockedStartLayout" at both the machine and user level
    foreach ($regAlias in $regAliases){
        $basePath = $regAlias + ":\SOFTWARE\Policies\Microsoft\Windows"
        $keyPath = $basePath + "\Explorer"
        IF(!(Test-Path -Path $keyPath)) {
            New-Item -Path $basePath -Name "Explorer" | Out-Null
        }
        Set-ItemProperty -Path $keyPath -Name "LockedStartLayout" -Value 1 | Out-Null
        Set-ItemProperty -Path $keyPath -Name "StartLayoutFile" -Value $layoutFile | Out-Null
    }
    
    #Restart Explorer, open the start menu (necessary to load the new layout), and give it a few seconds to process
    Stop-Process -name explorer
    Start-Sleep -s 3
    $wshell = New-Object -ComObject wscript.shell; $wshell.SendKeys('^{ESCAPE}')
    Start-Sleep -s 3
    $wshell = New-Object -ComObject wscript.shell; $wshell.SendKeys('^{ESCAPE}')
    Start-Sleep -s 3
    
    #Enable the ability to pin items again by disabling "LockedStartLayout"
    foreach ($regAlias in $regAliases){
        $basePath = $regAlias + ":\SOFTWARE\Policies\Microsoft\Windows"
        $keyPath = $basePath + "\Explorer"
        Set-ItemProperty -Path $keyPath -Name "LockedStartLayout" -Value 0 | Out-Null
    }
    
    #Restart Explorer and delete the layout file
    Stop-Process -name explorer
    
    # Uncomment the next line to make clean start menu default for all new users
    Import-StartLayout -LayoutPath $layoutFile -MountPath $env:SystemDrive\
}

  

function Remove_Startup {
    Write-Host -Object "[+] Remove_Startup" -ForegroundColor Green
    $user = New-Object System.Security.Principal.NTAccount($env:username)
    $sid = ($user.Translate([System.Security.Principal.SecurityIdentifier])).Value
    Remove-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*" -Recurse
    Remove-Item -Path "Registry::HKEY_USERS\S-1-5-19\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*" -Recurse
    Remove-Item -Path "Registry::HKEY_USERS\S-1-5-20\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*" -Recurse
    Remove-Item -Path "Registry::HKEY_USERS\$sid\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\*" -Recurse
}

  

function Remove_Tasks {
    Write-Host -Object "[+] Remove_Tasks" -ForegroundColor Green
    $ts = New-Object -ComObject Schedule.Service
    $ts.Connect($env:computername)
    $taskfolder = $ts.GetFolder('\')
    $tasks = $taskfolder.GetTasks(0)
    foreach($task in $tasks) {
        $taskfolder.DeleteTask($task.Name, 0)
    }
    
    $taskfolder = $ts.GetFolder('\Microsoft\Windows\UpdateOrchestrator')
    $tasks = $taskfolder.GetTasks(0)
    foreach($task in $tasks) {
        $taskfolder.DeleteTask($task.Name, 0)
    }
    
    $taskfolder = $ts.GetFolder('\Microsoft\Windows\WindowsUpdate')
    $tasks = $taskfolder.GetTasks(0)
    foreach($task in $tasks) {
        $taskfolder.DeleteTask($task.Name, 0)
    }
    
    $taskfolder = $ts.GetFolder('\Microsoft\Windows\Windows Defender')
    $tasks = $taskfolder.GetTasks(0)
    foreach($task in $tasks) {
        $taskfolder.DeleteTask($task.Name, 0)
    } 
}

function Set_KR_Time {
    Write-Host -Object "[+] Set_KR_Time" -ForegroundColor Green
    Set-TimeZone -Id "Korea Standard Time"
}

Export-ModuleMember -Function Disable_Defender
Export-ModuleMember -Function Disable_Update
Export-ModuleMember -Function Disable_Firewall
Export-ModuleMember -Function Set_Explorer
Export-ModuleMember -Function Set_Taskbar
Export-ModuleMember -Function Set_Startmenu
Export-ModuleMember -Function Set_KR_Time
Export-ModuleMember -Function Remove_Startup
Export-ModuleMember -Function Remove_Tasks
```

- **start_menu_layout.xml**

```XML
<LayoutModificationTemplate xmlns:defaultlayout="http://schemas.microsoft.com/Start/2014/FullDefaultLayout" xmlns:start="http://schemas.microsoft.com/Start/2014/StartLayout" Version="1" xmlns:taskbar="http://schemas.microsoft.com/Start/2014/TaskbarLayout" xmlns="http://schemas.microsoft.com/Start/2014/LayoutModification">
	<LayoutOptions StartTileGroupCellWidth="6" />
	<DefaultLayoutOverride>
		<StartLayoutCollection>
			<defaultlayout:StartLayout GroupCellWidth="6" />
		</StartLayoutCollection>
	</DefaultLayoutOverride>
</LayoutModificationTemplate>
```
        

## 분석 도구 설치

### get_tools.psm1

```PowerShell
function Test_WebConnection {
	param (
		[string]$url
	)

	Write-Host "[+] Test-WebConnection ($url)" -ForegroundColor Green

	if (-not (Test-Connection $url -Quiet)) {
		Write-Host "`t[!] It looks like you cannot ping $url.`n`t[!] Check your network settings." -ForegroundColor Red
		Start-Sleep 3
		exit 1
	}

	$response = $null
	try {
		$response = Invoke-WebRequest -Uri "https://$url" -UseBasicParsing
	}
	catch {
		Write-Host "`t[!] Error accessing $url. Exception: $($_.Exception.Message)`n`t[!] Check your network settings." -ForegroundColor Red
		Start-Sleep 3
		exit 1
	}

	if ($response -and $response.StatusCode -ne 200) {
		Write-Host "`t[!] Unable to access $url. Status code: $($response.StatusCode)`n`t[!] Check your network settings." -ForegroundColor Red
		Start-Sleep 3
		exit 1
	}

	Write-Host "`t[+] Internet connectivity check for $url passed"
}

function Download_Tools {
	param (
		$toolInfo,
		[string]$donwloadPath
	)

	function Download_Tool {
		param (
			[string]$download_url,
			[string]$outDirPath,
			[string]$outFileName
		)

		if ([Net.ServicePointManager]::SecurityProtocol -ne [Net.SecurityProtocolType]::Tls12) {
			Write-Host "`t`t[!] Plz Set Tls 1.2.`n`t`t[!] [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12" -ForegroundColor Red
			Start-Sleep 3
			exit 1
		}

		if (-not (Test-Path $outDirPath)) {
			New-Item -Path $outDirPath -ItemType Directory | Out-Null
		}

		$outFilePath = Join-Path -Path $outDirPath -ChildPath $outFileName
		if (Test-Path $outFilePath) {
			Write-Host "`t[!] Already Exist ($outFileName)" -ForegroundColor Yellow
		} else {
			Write-Host "`t[+] Download-Tool ($outFileName)"
			Invoke-WebRequest -Uri $download_url -OutFile $outFilePath
		}
	}

	$toolPath = Join-Path -Path $donwloadPath -ChildPath "tools"
	if (-not (Test-Path $toolPath)) {
		New-Item -Path $toolPath -ItemType Directory | Out-Null
	}

	[bool] $Is64 = $false
	if ([Environment]::Is64BitOperatingSystem) {
		$Is64 = $true
	}

	[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
	$toolType = $($toolInfo.type)
	Write-Host "[+] Dowload $toolType Tools" -ForegroundColor Green
	foreach ($tool in $toolInfo.tools) {
		if ($Is64) {
			if ($tool.Win64.availability) {
				$download_url = $tool.Win64.download_url
				$outDirName = "$($toolType)_win64"
				$outDirPath = Join-Path -Path $toolPath -ChildPath $outDirName
				Download_Tool $download_url $outDirPath $tool.Win64.download_file_name
			}
		} else {
			if ($tool.Win32.availability) {
				$download_url = $tool.Win32.download_url
				$outDirName = "$($toolType)_win32"
				$outDirPath = Join-Path -Path $toolPath -ChildPath $outDirName
				Download_Tool $tool.Win32.download_url $outDirPath $tool.Win32.download_file_name
			}
		}
	}
}

Export-ModuleMember -Function Test_WebConnection
Export-ModuleMember -Function Download_Tools
```
        
- **tools.json**
        
```JSON
[
  {
	"type": "Common",
	"tools": [
	  {
		"name": "7zip",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.7-zip.org/a/7z2301-x64.exe",
		  "download_file_name": "7z2301-x64.exe"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://www.7-zip.org/a/7z2301.exe",
		  "download_file_name": "7z2301.exe"
		}
	  },
	  {
		"name": "die",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/horsicq/DIE-engine/releases/download/3.09/die_win64_portable_3.09_x64.zip",
		  "download_file_name": "die_win64_portable_3.09_x64.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://github.com/horsicq/DIE-engine/releases/download/3.09/die_winxp_portable_3.09_x86.zip",
		  "download_file_name": "die_winxp_portable_3.09_x86.zip"
		}
	  },
	  {
		"name": "everything",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.voidtools.com/Everything-1.4.1.1024.x64-Setup.exe",
		  "download_file_name": "Everything-1.4.1.1024.x64-Setup.exe"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://www.voidtools.com/Everything-1.4.1.1024.x86-Setup.exe",
		  "download_file_name": "Everything-1.4.1.1024.x86-Setup.exe"
		}
	  },
	  {
		"name": "explorer-suite",
		"Win64": {
		  "availability": true,
		  "download_url": "https://ntcore.com/files/ExplorerSuite.exe",
		  "download_file_name": "ExplorerSuite.exe"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://ntcore.com/files/ExplorerSuite.exe",
		  "download_file_name": "ExplorerSuite.exe"
		}
	  },
	  {
		"name": "firefox",
		"Win64": {
		  "availability": true,
		  "download_url": "https://download-installer.cdn.mozilla.net/pub/firefox/releases/123.0/win64/ko/Firefox%20Setup%20123.0.exe",
		  "download_file_name": "Firefox Setup 123.0.exe"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://download-installer.cdn.mozilla.net/pub/firefox/releases/123.0/win32/ko/Firefox%20Setup%20123.0.exe",
		  "download_file_name": "Firefox Setup 123.0.exe"
		}
	  },
	  {
		"name": "hashmyfiles",
		"Win64": {
		  "availability": true,
		  "download_url": "http://www.nirsoft.net/utils/hashmyfiles-x64.zip",
		  "download_file_name": "hashmyfiles-x64.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "http://www.nirsoft.net/utils/hashmyfiles.zip",
		  "download_file_name": "hashmyfiles.zip"
		}
	  },
	  {
		"name": "hxd",
		"Win64": {
		  "availability": true,
		  "download_url": "https://mh-nexus.de/downloads/HxDSetup.zip",
		  "download_file_name": "HxDSetup.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://mh-nexus.de/downloads/HxDSetup.zip",
		  "download_file_name": "HxDSetup.zip"
		}
	  },
	  {
		"name": "notepadplusplus",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.6.4/npp.8.6.4.Installer.x64.exe",
		  "download_file_name": "npp.8.6.4.Installer.x64.exe"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.6.4/npp.8.6.4.Installer.exe",
		  "download_file_name": "npp.8.6.4.Installer.exe"
		}
	  },
	  {
		"name": "pebear",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/hasherezade/pe-bear/releases/download/v0.6.7.3/PE-bear_0.6.7.3_x64_win_vs13.zip",
		  "download_file_name": "PE-bear_0.6.7.3_x64_win_vs13.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://github.com/hasherezade/pe-bear/releases/download/v0.6.7.3/PE-bear_0.6.7.3_x86_win_vs13.zip",
		  "download_file_name": "PE-bear_0.6.7.3_x86_win_vs13.zip"
		}
	  },
	  {
		"name": "pestudio",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.winitor.com/tools/pestudio/current/pestudio.zip",
		  "download_file_name": "pestudio.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://www.winitor.com/tools/pestudio/current/pestudio.zip",
		  "download_file_name": "pestudio.zip"
		}
	  }
	]
  },
  {
	"type": "Dynamic",
	"tools": [
	  {
		"name": "fakenet",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/mandiant/flare-fakenet-ng/releases/download/v1.4.11/fakenet1.4.11.zip",
		  "download_file_name": "fakenet1.4.11.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://github.com/mandiant/flare-fakenet-ng/releases/download/v1.4.11/fakenet1.4.11.zip",
		  "download_file_name": "fakenet1.4.11.zip"
		}
	  },
	  {
		"name": "netcat",
		"Win64": {
		  "availability": true,
		  "download_url": "https://eternallybored.org/misc/netcat/netcat-win32-1.12.zip",
		  "download_file_name": "netcat-win32-1.12.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://eternallybored.org/misc/netcat/netcat-win32-1.12.zip",
		  "download_file_name": "netcat-win32-1.12.zip"
		}
	  },
	  {
		"name": "registrychangesview",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.nirsoft.net/utils/registrychangesview-x64.zip",
		  "download_file_name": "registrychangesview-x64.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://www.nirsoft.net/utils/registrychangesview.zip",
		  "download_file_name": "registrychangesview.zip"
		}
	  },
	  {
		"name": "ret-sync-xdbg",
		"Win64": {
		  "availability": true,
		  "download_url": "https://dev.azure.com/bootlegdev/dcc5ab7f-f16a-4986-ac25-9331eda171de/_apis/build/builds/109/artifacts?artifactName=ret-sync-release-x64dbg-x64&api-version=7.1&%24format=zip",
		  "download_file_name": "ret-sync-release-x64dbg-x64.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://dev.azure.com/bootlegdev/dcc5ab7f-f16a-4986-ac25-9331eda171de/_apis/build/builds/109/artifacts?artifactName=ret-sync-release-x64dbg-Win32&api-version=7.1&%24format=zip",
		  "download_file_name": "ret-sync-release-x64dbg-Win32.zip"
		}
	  },
	  {
		"name": "sysinternals-suit",
		"Win64": {
		  "availability": true,
		  "download_url": "https://download.sysinternals.com/files/SysinternalsSuite.zip",
		  "download_file_name": "SysinternalsSuite.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://download.sysinternals.com/files/SysinternalsSuite.zip",
		  "download_file_name": "SysinternalsSuite.zip"
		}
	  },
	  {
		"name": "taskschedulerview",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.nirsoft.net/utils/taskschedulerview-x64.zip",
		  "download_file_name": "taskschedulerview-x64.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://www.nirsoft.net/utils/taskschedulerview.zip",
		  "download_file_name": "taskschedulerview.zip"
		}
	  },
	  {
		"name": "wireshark",
		"Win64": {
		  "availability": true,
		  "download_url": "https://2.na.dl.wireshark.org/win64/Wireshark-4.2.3-x64.exe",
		  "download_file_name": "Wireshark-4.2.3-x64.exe"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://2.na.dl.wireshark.org/win32/Wireshark-win32-3.6.21.exe",
		  "download_file_name": "Wireshark-win32-3.6.21.exe"
		}
	  },
	  {
		"name": "x64dbg",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/x64dbg/x64dbg/releases/download/snapshot/snapshot_2024-02-19_03-16.zip",
		  "download_file_name": "snapshot_2024-02-19_03-16.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://github.com/x64dbg/x64dbg/releases/download/snapshot/snapshot_2024-02-19_03-16.zip",
		  "download_file_name": "snapshot_2024-02-19_03-16.zip"
		}
	  },
	  {
		"name": "x64dbg-plugin-manager",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/horsicq/x64dbg-Plugin-Manager/releases/download/0.06/x64plgmnr_win32_portable_0.06.zip",
		  "download_file_name": "x64plgmnr_win32_portable_0.06.zip"
		},
		"Win32": {
		  "availability": true,
		  "download_url": "https://github.com/horsicq/x64dbg-Plugin-Manager/releases/download/0.06/x64plgmnr_win32_portable_0.06.zip",
		  "download_file_name": "x64plgmnr_win32_portable_0.06.zip"
		}
	  }
	]
  },
  {
	"type": "Static",
	"tools": [
	  {
		"name": "eclipse",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.eclipse.org/downloads/download.php?file=/oomph/epp/2023-12/R/eclipse-inst-jre-win64.exe&r=1",
		  "download_file_name": "eclipse-inst-jre-win64.exe"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		},
		"__comment__": "Need '&r=1' string after download link"
	  },
	  {
		"name": "ghidra",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_10.2_build/ghidra_10.2_PUBLIC_20221101.zip",
		  "download_file_name": "ghidra_10.2_PUBLIC_20221101.zip"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		}
	  },
	  {
		"name": "jdk",
		"Win64": {
		  "availability": true,
		  "download_url": "https://download.oracle.com/java/17/latest/jdk-17_windows-x64_bin.exe",
		  "download_file_name": "jdk-17_windows-x64_bin.exe"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		}
	  },
	  {
		"name": "ret-sync-ghidra",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/bootleg/ret-sync/archive/refs/tags/ext_bn_community_release_v0.1.0.zip",
		  "download_file_name": "ret-sync-release-ghidra.zip"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		}
	  },
	  {
		"name": "vscode",
		"Win64": {
		  "availability": true,
		  "download_url": "https://aka.ms/win32-x64-user-stable",
		  "download_file_name": "win32-x64-user-stable.exe"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		}
	  },
	  {
		"name": "python",
		"Win64": {
		  "availability": true,
		  "download_url": "https://www.python.org/ftp/python/3.12.2/python-3.12.2-amd64.exe",
		  "download_file_name": "python-3.12.2-amd64.exe"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		}
	  },
	  {
		"name": "yara",
		"Win64": {
		  "availability": true,
		  "download_url": "https://github.com/VirusTotal/yara/releases/download/v4.5.0/yara-master-2251-win64.zip",
		  "download_file_name": "yara-master-2251-win64.zip"
		},
		"Win32": {
		  "availability": false,
		  "download_url": ""
		}
	  }
	]
  }
]
```
        

## ▸파이썬 라이브러리 설치

### install_python_libs.ps1

```PowerShell
function download_python_lib
{
	$libs = @(
		"pefile"
		"psutil"
	)
	python -m pip install --upgrade pip
	pip install --upgrade setuptools
	foreach ($lib in $libs)
	{
		pip install $lib
	}
}

download_python_lib
```