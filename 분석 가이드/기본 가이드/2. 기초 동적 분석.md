### 1. Process Explorer, Process Hacker, ProcMon 실행

### 2. 멀웨어 실행

### 3. 프로세스 트리 확인

악성코드는 시스템 프로세스를 할로잉하여 자신을 시스템 프로세스인 것처럼 속임. 다음 사항들을 유심히 볼 필요가 있음.
- 프로세스 이미지 경로
- PID
- 세션
- 부모 프로세스
- 인스턴스 수

예를 들어 svchost.exe는 service.exe를 부모로 가지고 Session은 0임.
#### svchost.exe를 할로잉한 악성코드
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160206326.png|300]]
#### 부모 프로세스가 존재하지 않음
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160206416.png|300]]

또는 시스템 프로세스와 비슷한 프로세스명을 사용하기도 함.
#### svchost와 비슷한 이름을 가진 SVOHOST를 이름으로 사용한 악성코드
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160208738.png|483]]

Process Explorer에서는 iamge와 memory 상의 문자열을 비교할 수 있음. 만약 서로 다르다면 패킹되어 있었다는 뜻임. 
#### 디스크 이미지 상에서는 존재하지 않는 문자열을 확인 -> 패킹되어 있었다는 뜻
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160212336.png|420]]

Process Hacker를 사용하면 프로세스의 메인 모듈뿐만 아니라 프로세스가 사용하는 전체 메모리의 문자열을 확인 가능. 의심스러운 문자열이 존재하는지 확인 가능.

#### 프로세스의 전체 메모리에서 사용하는 문자열을 확인 -> 의심스러운 문자열이 존재하는지 확인
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160214670.png|483]]

### 4. 프로세스 행위 확인

ProcMon에서는 생성된 프로세스들의 LifeTime을 확인할 수 있음.
#### 악성코드가 실행한 프로세스 트리
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160216435.png|439]]

또한 의심스러운 행위를 로깅하고 확인 가능.
#### 의심스러운 프로세스 생성
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160217980.png|584]]
#### 의심스러운 파일 생성
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160219248.png|483]]
#### 의심스러운 레지스트리 생성
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160219307.png|584]]

### 4. APIMiner를 사용하여 API 로깅

로깅된 API를 확인하여 어떤 분석이 더 필요한지 판단.
#### 가상 메모리의 속성을 변경하는 NtProtectVirtualMemory 확인 가능 => 코드 인젝션, 언패킹 등 예상 가능
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160220560.png|483]]
#### CreateProcessInternalW를 사용하여 svchost를 suspend로 실행 => 코드 인젝션 등 예상 가능
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160221623.png|483]]

### 6. fakenet을 사용하여 네트워킹 행위 로깅

로깅된 네트워킹 행위에서 의심스러운 행위가 존재하는지 확인
#### svchost에서 의심스러운 ip 주소와의 네트워킹 행위 확인 가능
![[images/2. 기초 동적 분석/IMG-2. 기초 동적 분석-20240818160222717.png|531]]

### 5. 위의 분석을 토대로 추가 분석 절차 결정

