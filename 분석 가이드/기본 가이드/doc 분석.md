## doc

Microsoft Word 97 ~ 2003에서 메인으로 사용한 포맷으로 `DO CF 11 E0` 파일 시그니처를 가짐. Microsoft Word 2007부터는 docx로 교체되었음. 이후 버전에서도 doc 문서의 작성/편집은 여전히 가능.

![](images/doc%20분석/IMG-doc%20분석-20240911134639250.png)

ssview를 사용하면 내부 구조를 확인할 수 있음.

![](images/doc%20분석/IMG-doc%20분석-20240911135636754.png)


## Analysis

### 1. oleid를 사용하여 내부 확인

oleid를 사용하면 내부 정보를 확인할 수 있음.

```cmd
oleid [file_path]
```

![](images/doc%20분석/IMG-doc%20분석-20240911135359650.png)

위 샘플에서는 VBA Macros가 존재하는 것으로 확인됨.

### 2. olevba를 사용하여 vba macros 확인

olevba를 사용하면 vba macros 코드와 의심스러운 키워드를 검색해줌.

![](images/doc%20분석/IMG-doc%20분석-20240911140121235.png)

아래 코드를 사용하면 결과를 txt 파일로 저장하여 vba 코드 확인 가능

```cmd
olevba dropped.doc > olevba_result
```

![](images/doc%20분석/IMG-doc%20분석-20240911140402083.png)

### 3. MS Word 디버거 사용

vba 코드를 획득했다면, MS Word를 열어서 `Alt + F11`로 MS Word 내의 디버거를 실행.

![](images/doc%20분석/IMG-doc%20분석-20240911140658483.png)

획득한 vba 코드를 붙여넣기하고 실행시켜 디버깅이 가능.

![](images/doc%20분석/IMG-doc%20분석-20240911140807459.png)

`Ctrl + G`를 눌러 즉시 실행 창을 열고, 아래 명령어를 사용하면 원하는 변수의 값을 알 수 있음.

```vba
Debug.Print [원하는 변수 명]
```

![](images/doc%20분석/IMG-doc%20분석-20240911141146953.png)