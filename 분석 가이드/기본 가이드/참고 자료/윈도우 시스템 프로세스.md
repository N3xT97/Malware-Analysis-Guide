악성코드는 자신의 감추기 위해 윈도우 프로세를 할로잉하거나 윈도우 프로세스와 비슷한 이름을 사용함.
윈도우 프로세스의 종류와 특징을 사용해 프로세스 트리를 확인하고 의심스러운 프로세스를 찾아낼 수 있음.

#### 프로세스 분석 도구를 사용하여 확인한 프로세스 트리와 관련 정보
![439](images/윈도우%20시스템%20프로세스/IMG-윈도우%20시스템%20프로세스-20240818160206331.png)

#### 속성을 확인하면 이미지 경로와 부모 프로세스도 확인 가능
![363](images/윈도우%20시스템%20프로세스/IMG-윈도우%20시스템%20프로세스-20240818160206422.png)

| Process              | Parent Process           | PID | Session       | Exit |
| -------------------- | ------------------------ | --- | ------------- | ---- |
| System Idle Process  |                          | 0   |               | X    |
| System               | System Idle Process      | 4   |               | X    |
| smss.exe (master)    | System                   |     | 0             | X    |
| smss.exe (Session 0) | smss.exe (master)        |     | 0             | O    |
| smss.exe (Session 1) | smss.exe (master)        |     | 1             | O    |
| csrss.exe            | smss.exe (Session 0)<br> |     | 0             | X    |
| wininit.exe          | smss.exe (Session 0)     |     | 0             | X    |
| lsass.exe            | wininit.exe              |     | 0             | X    |
| lsm.exe              | wininit.exe              |     | 0             | X    |
| services.exe         | wininit.exe              |     | 0             | X    |
| svchost.exe          | services.exe             |     | 0 or 1        | X    |
| csrss.exe            | smss.exe (Session 1)     |     | 1             | X    |
| winlogon.exe         | smss.exe (Session 1)     |     | 1 and highier | X    |
| userinit.exe         | winlogon.exe             |     | 1             | O    |
| explorer.exe         | userinit.exe             |     | 1             | X    |

## smss.exe(Session Manager Subsystem)

시작하는 첫 번째 프로세스 중 하나이며 Windows 세션을 초기화하는 역할. 첫 번째 smss.exe는 각 새 세션에 대한 자식 smss.exe를 생성. 세션 0의 자식 smss.exe는 csrss.exe와 winit.exe를 시작하여 새 세션을 초기화. 세션 1의 자식 smss.exe는 winlogon.exe를 시작하여 새 세션을 초기화. 그 후 자식 smss.exe들은 종료.

**이미지 경로**: %SystemRoot%\\System32\\smss.exe
**부모 프로세스**: System
**인스턴스** 수: 마스터 인스턴스 하나와 자식 인스턴스 하나당 하나. 자식들은 세션을 만든 후에 종료.
**사용자 계정**: Local System

## csrss.exe(Client/Server Runtime Subsystem)

그래픽 인터페이스를 관리하고 사용자 모드 시스템 기능에 대한 스레드를 생성하고 삭제. Windows 환경의 그래픽 요소를 관리하는 데 중요한 역할.

**이미지 경로:** %SystemRoot%\\System32\\csrss.exe
**부모 프로세스**: 종료되는 smss.exe에 의해 생성. 일반적으로 부모 프로세스 이름을 제공하지 않음.
**인스턴스** 수: 둘 이상  
**사용자 계정**: Local System

## wininit.exe(Windows Initialization Process)

시스템 초기화 중에 Windows Defender, Windows Event log 등과 같은 서비스와 USB, Webcam 등의 드라이버를 시작하는 역할. 다양한 시스템 구성 요소가 로드되고 적절하게 초기화되는지 확인.

**이미지 경로**: %SystemRoot%\\System32\\wininit.exe  
**부모 프로세스**: 종료하는 smss.exe의해 생성됨. 일반적으로 상위 프로세스 이름을 제공하지 않음.
**인스턴스** 수: 1개  
**사용자 계정**: Local System

## services.exe(Services and Controller App)

시스템 서비스의 시작, 중지 및 관리를 담당. 필요에 따라 다양한 백그라운드 작업과 서비스가 실행되도록 함.

**이미지 경로**: %SystemRoot%\\System32\\services.exe  
**부모 프로세스**: wininit.exe  
**인스턴스** 수: 1개  
**사용자 계정**: Local System

## svchost.exe(Service Host)

이 프로세스의 여러 인스턴스는 **Netman(**Network Connection Manager service), Themes** 등과 같은 다양한 시스템 서비스를 호스팅하고 관리하기 위해 실행됩니다. 이러한 서비스는 리소스 활용 및 관리를 개선하기 위해 함께 그룹화됩니다.

**이미지 경로**: %SystemRoot%\\system32\\svchost.exe
**부모 프로세스**: services.exe (대부분)
**인스턴스** 수: 다수 (일반적으로 최소 10개 이상)
**사용자 계정**: 일반적으로 로컬 시스템, 네트워크 서비스, 로컬 서비스 계정. svchost.exe에 따라 다름. Windows 10에는 로그온 사용자로 실행되는 인스턴스도 있음.

## lsass.exe(Local Security Authority Subsystem Service)

HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa에 지정된 적절한 인증 패키지를 호출하여 사용자를 인증하는 역할을 함. 인증 패키지는 일반적으로 도메인 계정의 경우 Kerberos 또는 로컬 계정의 경우 MSV1_0임. 사용자 인증 외에도 lsass.exe는 로컬 보안 정책(예: 암호 정책 및 감사 정책)을 구현하고 보안 이벤트 로그에 이벤트를 기록하는 역할도 함.

**이미지 경로**: %SystemRoot%\\System32\\lsass.exe  
**상위 프로세스**: wininit.exe  
**인스턴스** 수: 1개  
**사용자 계정**: Local System

## lsaiso.exe(Local Security Authority Isolation)

LSASS에 별도의 격리된 환경을 제공하여 공격 표면을 줄여 보안을 강화. Credential Guard가 활성화되지 않은 경우 lsaiso.exe는 시스템에서 실행되지 않아야 함.

**이미지 경로**: %SystemRoot%\\System32\\lsaiso.exe
**상위 프로세스**: wininit.exe
**인스턴스** 수: 0 또는 1개
**사용자 계정**: Local System

## winlogon.exe(Windows Logon Application)

인증 및 사용자 프로필로드를 포함하여 사용자 로그온 및 로그 오프 프로세스를 처리. 로그인 화면을 표시하고 사용자 세션을 관리하는 역할. 사용자가 인증되면 Winlogon은 사용자의 ntuser.dat를 HKCU에 로드하고 userinit.exe를 통해 사용자의 쉘 ​​(일반적으로 Explorer.exe)을 시작.

**이미지 경로**: %SystemRoot%\\System32\\winlogon.exe  
**상위 프로세스**: 종료되는 smss.exe에 의해 생성. 상위 프로세스 이름을 제공하지 않음.
**인스턴스** 수: 하나 이상  
**사용자 계정**: Local System

## explayer.exe(Windows Explorer)

작업 표시줄, 바탕 화면 및 파일 탐색기를 포함한 Windows용 그래픽 사용자 인터페이스(GUI)를 제공. 사용자가 시스템과 상호 작용하고 응용 프로그램을 시작할 수 있음.

**이미지 경로**: %SystemRoot%\\explorer.exe
**상위 프로세스**: 종료되는 userinit.exe에 의해 생성. 부모 프로세스 이름을 제공하지 않음.  
**인스턴스** 수: 1개 혹은 대화형으로 로그온한 사용자당 하나
**사용자 계정**: <logged-on user(s)>