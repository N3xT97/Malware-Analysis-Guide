## 닷넷 로더 분석

### ProcessHacker를 사용해 의심스러운 모듈 확인

의심스러운 .NET 파일을 실행했는데, 하위 프로세스로 aspent_compliler.exe를 실행함을 확인함.

![531](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160206327.png)

해당 하위 프로세스를 확인해보면 의심스러운 모듈을 확인할 수 있음.

![584](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160206418.png)

### dnspy를 사용해 의심스러운 하위 프로세스 분석

dnspy의 attach to process 기능을 사용하여 의심스러운 하위 프로세스에 attach.

![531](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160208983.png)

attach한 프로세스의 modules을 확인. 의심스러운 프로세스 모듈을 확인할 수 있음.

![399](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160212530.png)

![584](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160214932.png)

Go To Module로 해당 모듈의 파일 확인. 이때 확인되는 정보는 디스크 상의 정보로 의심스러운 API를 확인할 수 없음.

![330](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160216667.png)

![273](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160218064.png)

Open Module from Memory로 해당 모듈의 메모리를 확인. 이때 확인되는 정보는 메모리 상의 정보로 의심스러운 API를 확인할 수 있음. 즉, 정상적인 파일을 호출한 후 메모리 상에서 이미지를 덮어 쓰는 할로잉이 되었을 가능성이 높음.

![439](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160219386.png)

![516](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160220640.png)

Go to EntryPoint를 사용하면 내부를 확인할 수 있음.

![300](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160221711.png)

![483](images/닷넷%20패커%20분석/IMG-닷넷%20패커%20분석-20240818160222876.png)