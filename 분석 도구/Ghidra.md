---
os:
  - win10
  - win11
type:
  - disassem
생성 일시: Invalid date
최종 편집 일시: Invalid date
---
> [!info] Ghidra  
>  
> [https://ghidra-sre.org/](https://ghidra-sre.org/)  

# ✅Ghidra 요구 환경

- JDK 필요
- 64bit 운영체제

# ✅권장 설정

## 하이라이트

- Listing창과 Decompile창에서 변수나 텍스트를 휠클릭 시, 대상과 같은 문자열이 강조됨
- 노트북의 경우 휠클릭이 불가능하므로 좌클릭으로 변경
- Edit > Tool Options
    
    ![[images/Ghidra/IMG-Ghidra-20240818160208293.png|IMG-Ghidra-20240818160208293.png]]
    

## 단축키 설정

- Previous Data Type in : [B]
    - History 창에서 이전에 커서가 있던 위치로 돌아감
- Find References To : [X]
    - Listing 창에서 대상 주소를 참조하는 주소를 일람
- Find References to Symbol : [X]
    - Decompile 창에서 대상 주소를 참조하는 주소 일람을 표시
- Edit > Tool Options
    
    ![[images/Ghidra/IMG-Ghidra-20240818160210797.png|IMG-Ghidra-20240818160210797.png]]
    

## 어셈블리어 행간

- 기본 설정은 3이지만, 한번에 보기 쉽게 1로 변경
- Edit > Tool Options
    
    ![[images/Ghidra/IMG-Ghidra-20240818160213403.png|IMG-Ghidra-20240818160213403.png]]
    

## 디컴파일 창 코멘트 노출

- 디컴파일 창의 코멘트는 리스트 창에 비해 적게 표시됨
- 설정을 통해 추가 코멘트를 표시
- Edit > Tool Options
    
    ![[images/Ghidra/IMG-Ghidra-20240818160215600.png|IMG-Ghidra-20240818160215600.png]]
    

## XRef 표시 항목 설정

- 리스트 창에서 XREF를 더블 클릭하면 참조 관계를 나타내는 창이 오픈됨
    
    ![[images/Ghidra/IMG-Ghidra-20240818160217372.png|IMG-Ghidra-20240818160217372.png]]
    
- 항목에서 우클릭 Add/Remov Colums 메뉴에서 Function Signature와 EOL Comment 추가
    
    ![[images/Ghidra/IMG-Ghidra-20240818160218729.png|IMG-Ghidra-20240818160218729.png]]
    

# ✅Ghidra 기능

## 🔹프로그램 자동 분석 기능

- 자동으로 포맷과 언어를 잡아서 임포트
    
    ![[images/Ghidra/IMG-Ghidra-20240818160220067.png|IMG-Ghidra-20240818160220067.png]]
    
- 임포트 결과
    
    ![[images/Ghidra/IMG-Ghidra-20240818160221291.png|IMG-Ghidra-20240818160221291.png]]
    
- 임포트 후에는 분석 기능 제공
    
    - PE32 파일을 분석할 시, WindowsPE x86 Propagate External Parmeters를 체크
    - 함수 매개변수 추가 정보를 분석해
    
    ![[images/Ghidra/IMG-Ghidra-20240818160222352.png|IMG-Ghidra-20240818160222352.png]]
    

## 🔹Code Browser

- 코드 브라우저
    
    ![[images/Ghidra/IMG-Ghidra-20240818160223391.png|IMG-Ghidra-20240818160223391.png]]
    
    - Program Trees
        - 프로그램 구조를 분석해 단위로 분할 표시
        - PE 구조의 경우 헤더나 섹션으로 분할
    - Symbol Tree
        - 프로그램 내의 심벌 관련 정보
    - Data Type Manager
        - 프로그램 내의 데이터 형에 관한 정보 표시
    - Decompile
        - 디스어셈블한 프로그램을 C언어로 디컴파일한 결과 표시
    - Console
        - Ghidra Script 및 Ghidra Extention 출력 결과

## 🔹Listing 창

- 함수 정보 편집
    
    - 함수 정보 영역에서 우클릭
    
    ![[images/Ghidra/IMG-Ghidra-20240818160224232.png|IMG-Ghidra-20240818160224232.png]]
    
    ![[images/Ghidra/IMG-Ghidra-20240818160225383.png]]
    
- 라벨 정보 편집
    
    - 어셈블리어의 함수 이름, 변수 이름 등에서 우클릭
    
    ![[images/Ghidra/IMG-Ghidra-20240818160226212.png]]
    
    ![[images/Ghidra/IMG-Ghidra-20240818160226593.png]]
    
    - Enter Name : 변경할 이름
    - Namespace : 네임스페이스 지정
    - Entery Point : EP 설정
    - Primary : 여러 라벨이 있을 경우 1차 라벨로 설정
    - Pinned : 이미지 기반 변경이나 메모리 블록 이동의 영향을 받지 않도록 라벨 고정
- 마커
    - 마커를 이용하여 프로그램 내의 특정 위치를 북마크와 플러그인을 통해 지정 가능
    - 마진 마커
        
        - 포인트 마커 : 한행 선택 (하늘)
        
        ![[images/Ghidra/IMG-Ghidra-20240818160227149.png]]
        
        - 에어리어 마커 : 여러행 선택 (녹색)
        
        ![[images/Ghidra/IMG-Ghidra-20240818160227488.png]]
        
    - 네비게이션 마커
        
        - Listing 창 우측에 바 형태로 존재
        
        ![[images/Ghidra/IMG-Ghidra-20240818160227845.png]]
        
- 엔트로피
    
    - 정보량을 나타내는 값, 높을수록 정보량이 많아짐
    - 데이터가 인코딩이나 암호화되어 있을 경우에 엔트로피가 높아짐
    
    ![[images/Ghidra/IMG-Ghidra-20240818160228052.png]]
    
- 오버뷰
    
    - 프로그램에 존재하는 다양한 유형을 색으로 표시해줌
    
    ![[images/Ghidra/IMG-Ghidra-20240818160228256.png]]
    
- 흐름 화살표
    
    - 화살표를 더블 클릭하면, 점프처와 점프원을 이동할 수 있음
    - 조건부 점프 = 점
    - 무조건 점프 = 실선
    
    ![[images/Ghidra/IMG-Ghidra-20240818160228455.png]]
    
- 하이라이트
    
    - Listing 창 내의 요소를 클릭하면, 그 요소가 강조
        - 대문자, 소문자를 구별함
        - 일치하는 문자열은 밝은 노란색으로 강조
    - 레지스터에는 스코프가 적용됨
        - 연녹 = 판독
        - 어두운 노랑 = 기입
        - 밝은 노랑 = 현재 스코프 외에 있는 레지스터
    
    ![[images/Ghidra/IMG-Ghidra-20240818160228565.png]]
    
- 코멘트
    
    - 우클릭 > Comments
        
        ![[images/Ghidra/IMG-Ghidra-20240818160228677.png]]
        
          
        
    
    ![[images/Ghidra/IMG-Ghidra-20240818160228798.png]]
    
    - EOL(End-Of-Line) Comment
        - 오퍼랜드 오른쪽에 표시
        - 기드라가 자동으로 코멘트를 부여하는 윈도우 API의 인수 등도 표시
    - Plate Comment
        - 어셈블리어의 상부에 *로 둘러쌓인 헤더로서 함수나 외부 라이브러리의 처음에 표시
        - 그 영역이 어떤 영역인지를 나타내는 코멘트나 라이브러리 이름, 심벌 정보 등이 표시
        - 기드라가 붙인 코멘트는 편집 화면에 보이지 않지만 코멘트를 추가하면 덮어 쓰여짐
    - Post Comment
        - 어셈블리어 하부에 표시
    - Pre Comment
        - 어셈블리어 하부에 표시
    - Repeatable Comment
        - EOL 코멘트가 없는 경우, 오퍼랜드 오른쪽에 표시
        - 주석 붙이 ㄴ영역을 참조하는 영역에도 표시
        - 이미 EOL 코멘트나 Repeatable 코멘트가 입력되어 있다면 표시되지 않음

## 🔹Deocompile 창

- 현재 표시 중인 어셈블리 언어를 C 언어로 변환하여 보여줌
    
    ![[images/Ghidra/IMG-Ghidra-20240818160228938.png]]
    
- 마우스 조작
    - 왼쪽 클릭 : 하이라이트 표시
    - 우클릭 : 메뉴 표시
    - 중앙 클릭 : 일치하는 문자열 모두 하이라이트 표시
    - 더블 클릭 : 대상이 링크면 이동
    - Ctrl + 더블 클릭 : 별도 창에서 대상을 snapshot으로 표시
- 하이라이트
    
    - 우클릭 > Highlight
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229054.png]]
    
    - Highlight Def-Use : 선택한 변수가 사용되는 모든 장소를 강조, 변수의 정의 부분은 강조되지 않음
    - Highlight Forward Slice : 선택한 변수에 따라 영향을 받을 수 있는 변수 강조
    - Highlight Backward Slice : 선택한 변수값에 영향을 주는 함수 내의 모든 변수 강조
    - Highlight Forward Instruction Slice
        
        : [Highlight Forward Slice]에서 강조되는 변수가 포함된 명령 전체를 강조
        
    - Highlight Backward Instruction Slice
        
        : [Highlight Backward Slice]에서 강조되는 변수가 포함된 명령 전체를 강조
        
- 커밋
    
    - 디스어셈블된 코드를 바탕으로 대상 컴파일 결과를 표시
    - Decomplie 창에서 편집한 정보를 데이터베이스에 저장
    - Listing 창에서 사용되는 정보와 Decomplie 창 정보를 동기화
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229166.png]]
    
    - Commit Params/Return : 함수의 인수와 반환값의 정보를 동기화
    - Commit Locals : 로컬 변수의 정보를 동기화
- 코멘트
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229274.png]]
    
    - Listing 창의 코멘트와 연동됨
    - 기본적으로는 Plate, Pre Comment를 제공
    - 설정에서 옵션을 활성화하면 Post, EOL Comment도 표시 가능
- 검색
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229403.png]]
    
    - Ctrl + F
    - 정규 표현과 문자열 검색 기능 제공

## 🔹Symbol Tree 창

- 프로그램 내에 포함된 심벌 정보를 보여줌
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229541.png]]
    
- Imports
    
    : 임포트하고 있는 라이브러리와 DLL로부터 임포트하고 있는 함수, 인수의 정의가 표시
    
- Exports
    
    : 프로그램의 엔트리 포인트를 나타내는 entry 표시
    
    : DLL이 제공하는 함수 등 대상 프로그램에서 익스포트하고 있는 함수와 인수가 표시
    
- Functions
    
    : 외부 함수를 제외한 프로그램 내 함수의 심벌 정보와 인수가 표시, 임포트된 함수도 포함
    
- Labels
    
    : 함수명과는 별도로 부여되어 있는 라벨명 등 글로벌 네임스페이스에 있는 심벌이 표시
    
- Classes
    
    : C++ 클래스 네임스페이스의 심벌 정보와 함수 이름, 인수가 표시
    
- Namespace
    
    : 일반적인 네임 스페이스가 표시, Classes에 포함된 정보도 포함
    
    : switch문 분기에서 사용되는 라벨이나 글로벌 네임스페이스에 존재하는 클래스, 함수, 라벨 등
    

## 🔹Data Type Manager 창

- Data Type 검색, 정리, 적용이 가능
- 사용자가 자체적으로 Data Type 라이브러리를 구축 가능
    
    ⇒ 프로그램, 프로젝트, 다른 사용자와 공유할 수도 있음
    
- Data Types
    - Bult-in
        
        : 바이트, 워드, 문자열 등의 기본적인 표준형에 사용
        
    - User Defined
        
        : 구조체, 공용체, 열거형, 형 정의의 4가지 타입이 있음
        
    - Derived
        
        : 포인터와 배열 두 가지가 있음
        
        : 포인터 배열 편집은 가능하나 이름은 변경 불가능
        

![[images/Ghidra/IMG-Ghidra-20240818160229654.png]]

- Data Type Archives
    - Data Type Archives는 데이터 형을 만들어 공유하기 위해서 사용
    - Built-in archive data types(주황색)
        
        : 기드라에서 제공되는 표준 데이터형이 정의됨
        
        : 분석 대상 파일에 의존하지 않고 항상 이용 가능
        
    - File Archive(빨간색)
        
        : 외부 라이브러리 내에서 정의되는 데이터 형이 저장되어 있는 파일
        
        : 동시에 여러 사용자가 여는 것은 가능하지만 변경은 한 명만 가능
        
    - Project Archive(검은색)
        
        : 다중 사용자 환경에서 버전 관리 및 공유 가능
        
        : 기드라 프로젝트 데이터베이스 디렉터리에 저장해야 함
        
    - Program data types(초록색)
        
        : 프로그램 내에 저장되어 있는 데이터 형
        

## 🔹Program Tree 창

- 프로그램 헤더 정보를 불러와서 헤더나 섹션별로 디렉터리와 fragment라는 단위로 분할하여 표시
- Listing 창과 연동되어 있으며, 데이터 영역, 섹션 명을 클릭해 해당 영역을 Listing 창에 표시 가능
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229773.png]]
    
- 오른쪽 상단의 버튼을 통해 여러 개의 Tree도 작성 가능
    
    ![[images/Ghidra/IMG-Ghidra-20240818160229890.png]]
    
- 우클릭을 통해 기존 Tree를 편집도 가능
    
    ![[images/Ghidra/IMG-Ghidra-20240818160230007.png]]
    
    - Modularize By : 프로그램을 분석해 자동으로 fragment를 추가할 수 있음
    - Sort : 주소나 이름으로 정렬 가능
    
      
    

## 🔹Bookmarks 창

- 북마크를 리스트로 보여줌
- 기본적으로 북마크 Type, Category, 상세 정보가 기술된 Description, 북마크 주소를 나타내는 Location,
    
    Location 영역의 Label, Location 영역의 디스어셈블 부분을 뽑아낸 Code Unit을 제공
    
    ![[images/Ghidra/IMG-Ghidra-20240818160230167.png]]
    
- 북마크 Type
    
    - Analysis(주황색) : Auto Analysis에 의해 추가
    - Error(빨간색) : 디스어셈블러나 Auto Analysis에 의해서 추가되는 에러
    - Info(시안색) : 플러그인에 의해 추가
    - Note(보라색) : 사용자에 의해 추가
    - Warning(마젠타색) : Auto Analysis에 의해 추가되는 경고
    
      
    

## 🔹Bytes 창

- 분석 대상 프로그램을 16진수 덤프로 표시
    - Start : 메모리의 최소 주소를 나타냄
    - End : 메모리의 최대 주소를 나타냄
    - Offset : 각 메모리에 추가된 바이트
    - Insertion : 커서가 있는 곳의 주소

![[images/Ghidra/IMG-Ghidra-20240818160230320.png]]

- 기본적으로 16진수로 보이지만 다른 옵션을 추가할 수 있음
    - Ascii 표시를 추가하는 것이 분석할 때 도움이 됨

![[images/Ghidra/IMG-Ghidra-20240818160230480.png]]

![[images/Ghidra/IMG-Ghidra-20240818160230659.png]]

- 데이터 복사
    - 선택한 영역을 클립보드에 복사할 수 있음
    - 우클릭 > Copy Special > Byte String (No Spaces) : 공백 없이 복사 가능

![[images/Ghidra/IMG-Ghidra-20240818160230849.png]]

- 하이라이트
    
    - 선택한 영역을 강조할 수 있음
        - 우클릭 > Program Highlight > Entire Selection
    
    ![[images/Ghidra/IMG-Ghidra-20240818160230968.png]]
    
    - 강조된 영역을 편집할 수 있음
        - 우클릭 > Program Highlight >
            - Add Selection : 강조를 추가
            - Clear : 모든 강조 삭제
            - Entire Selection : 다른 영역을 강조, 기존 영역은 삭제됨
            - Subtract Selection : 기존 영역에서 일부를 삭제
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231099.png]]
    

## 🔹Defined String 창

- 프로그램 내에서 정의되는 문자열 목록을 보여줌
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231235.png]]
    
- 프로그램을 분석할 때 판독 가능한 문자열 정보는 상당히 도움이 됨
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231360.png]]
    
- 기본 정보
    - Location : 문자열의 선두 주소
    - String Value : 문자열의 값
    - String Representation : 문자열을 문자로 표현 가능한 형태로 표시
    - Type : 문자열 유형
- 추가 정보
    - Charset : 문자 코드의 종류
    - Is Ascii : 아스키 코드 이외의 문자가 포함되는지 확인
    - Has Encoding Error : 지정 문자 코드에서 변환 시 에러가 발생했는지를 나타

  

## 🔹Function Call Graph 창

- 함수의 호출 관계를 계층화 하고 가시화
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231492.png]]
    
    - 기본적으로 Listing 창에서 보이는 함수가 호출하는 함수와 호출원을 한 계층씩 보여줌
    - 소스 함수와 관련된 함수가 모두 표시
    - 소스 함수와 직접 호출 관계가 없는 화살표는 연한 색깔 선으로 표시
- Satellite View
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231602.png]]
    
    - 그래프 개요가 표시됨
    - 노드가 많이 보여 구조가 복잡해지면 전체를 파악하기가 어려움
    - 확대 표시한 곳이 창의 어느 부분에 해당하는지 보여줌

## 🔹Function Graph

- Listing 창에서 보이는 함수를 베이직 블록, 코드 블록으로 그래프화하여 보여줌
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231724.png]]
    
- 분기 처리가 가시화되어 직감적으로 제어 흐름을 파악하기 쉬워짐
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231835.png]]
    
- 코드 표시 영역 확대
    
    - 베이직 블록의 가로 폭이 부족하여 주소, 명령, 오퍼랜드가 중간까지만 표시될 수 있음
    - 그럴 때는 [Edit Code Block Fields]로 주소, 명령, 오퍼랜드 부분의 횡폭을 확장하여 개선할 수 있음
    
    ![[images/Ghidra/IMG-Ghidra-20240818160231958.png]]
    
    ![[images/Ghidra/IMG-Ghidra-20240818160232090.png]]
    
- 코멘트 표시
    
    - Function Graph 창 기본 상태에서는 코멘트가 표시되지 않음
    - 앞서 설정한 [Edit Code Block Fields]에서 코멘트 설정 변경 가능
        - 우클릭 → [Add Field] → [EOL Comment], [Pre-Comment], [Post-Comment] 추가
    
    ![[images/Ghidra/IMG-Ghidra-20240818160232209.png]]
    
    ![[images/Ghidra/IMG-Ghidra-20240818160232323.png]]
    
- Edge
    
    - Function Graph 창에서 보이는 화살표를 Edge라 함
        - 빨간색 = 조건부 체크 false
        - 초록색 = 조건부 체크 true
        - 파란색 = 조건 없는 흐름
    
    ![[images/Ghidra/IMG-Ghidra-20240818160232440.png]]
    
- 버튼
    - Go To Function Entry Point
        
        ![[images/Ghidra/IMG-Ghidra-20240818160232558.png]]
        
        - 클릭하면 함수의 선두로 이동
    - Reloads Graph
        
        ![[images/Ghidra/IMG-Ghidra-20240818160232687.png]]
        
        - 그래프의 노드 레이아웃을 초기 표시 위치로 이동
    - Nested Code Layout
        
        ![[images/Ghidra/IMG-Ghidra-20240818160232844.png]]
        
        - C언어의 네스트와 유사한 레이아웃으로 표시
    - Block Hover Mode
        
        ![[images/Ghidra/IMG-Ghidra-20240818160232964.png]]
        
        - 코드 블록을 마우스 오버했을 때의 제어 흐름 강조 설정 변경
        - 점선 표시
        - 기본값 = [Show Scoped Flow From Block]
    - Block Focus Mode
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233079.png]]
        
        - 코드 블록 선택 시 제어 흐름의 하이라이트 설정 변경
        - 굵은 선 표시
        - [Off]
            - 강조 기능 무효화
        - [Show Scoped Flow From Block]
            - 현재 코드 블록을 실행했을 때 도달 가능한 제어 흐름을 강조
        - [Show Scoped Flow To Block]
            - 최종적으로 현재 코드 블록에 도달하는 제어 흐름을 강조
        - [Show Paths To/From Block]
            - 현재 코드 블록에 도달하는 모든 제어 흐름과 도달 가능한 모든 제어 흐름을 강조
        - [Show Paths From Block]
            - 현재 코드 블록을 통과하여 도달가능한 블록으로 향하는 흐름을 강조
        - [Show Paths To Block]
            - 현재 코드 블록에 도달하는 모든 제어 흐름을 강조
        - [Show Loops Containing Block]
            - 현재 코드 블록을 통과하는 루프의 제어 흐름을 강조
        - [Show Paths From Focus to Hover](hover mode only)
            - 초점을 맞춘 코드 블록에서 마우스 오버한 블록까지의 제어 흐름을 강조
        - [Show All Loops In Function] = 기본값
            - 함수 내의 모든 루프를 강조
- 블록 메뉴
    - Function Graph 창 안에 표시되는 코드 블록 상단에는 블록 메뉴가 존재
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233191.png]]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233308.png]]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233434.png]]
        
    - Set this block’s background color
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233549.png]]
        
        - 코드 블록 배경색 설정
    - Jump to a XRef
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233667.png]]
        
        - 함수의 선두 블록에만 표시됨, 함수의 호출원 참조 일람을 표시
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233783.png]]
        
    - Reverts view from graph to fullscreen
        
        ![[images/Ghidra/IMG-Ghidra-20240818160233906.png]]
        
        - 코드 블록을 풀스크린 표시
    - Reverts view from full screen to graph
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234024.png]]
        
        - 코드 블록을 풀스크린으로 표시하는 것에서 일반 그래프 뷰로 전환
    - Combine selected vertices into one vertex
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234134.png]]
        
        - 복수의 코드 블록을 vertex라 부르는 그룹으로 정리
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234256.png]]
        
    - Ungroup selected vertices into individual vertex
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234394.png]]
        
        - vertex에만 표시되는 아이콘. vertex 해제
    - Add the selected vertices to this group
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234513.png]]
        
        - vertex에만 표시되는 아이콘 ,vertex 추가
    - Restore Group
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234674.png]]
        
        - vertex를 해제한 블록에 나타남. 다시 해제한 vertex로 정리

## 🔹공통 항목

- 공통 버튼
    - 새로고침
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234786.png]]
        
    - 선택한 영역의 데이터 복사
        
        ![[images/Ghidra/IMG-Ghidra-20240818160234904.png]]
        
    - 선택한 영역에 복사한 데이터 붙여넣기
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235019.png]]
        
    - 현재 화면을 스냅숏이라는 별도의 창으로 표시
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235145.png]]
        
    - 표시되는 필드를 추가로 배치 조정 (Listing 창과 Function Graph 창에만 있는 아이콘)
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235258.png]]
        
    - 창 내에서 선택한 데이터와 대응하는 영역을 Listing 창에서 선택
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235379.png]]
        
    - 필터 설정
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235497.png]]
        
    - 창 내 선택과 Listing 창의 표시 영역 연동
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235619.png]]
        
    - 선택한 데이터 삭제
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235735.png]]
        
- Fliter
    - 텍스트 필터 필드에 문자를 입력하여 필터링 가능
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235852.png]]
        
    - [Text Filter Options]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160235984.png]]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160236097.png]]
        
        - [Text Filter Strategy]
            - 필터 매칭 방법 설정
                - [Contains] = 테이블 내의 어느 하나의 칼럼에 입력한 문자가 포함되는 경우
                - [Starts With] = 테이블 내 하나의 칼럼이 입력한 문자로 시작하는 경우
                - [Matches Exactly] = 테이블 내의 어느 칼럼이 입력한 문자와 완전히 일치하는 경우
                - [Regular Expression] = 정규 표현을 사용하여 검색하고 일치하는 경우
            - [Case Sensitive] = 대문자와 소문자가 구별됨
            - [Allow Globbing] = 글로빙 문자 *(임의 수의 글자) 및 ?(단일 글자)를 와일드카드로 분석
            - [Invert Filter] = 체크하면 필터 조건이 반전
            - [Enable Multi-Term Filtering] = 복수의 단어를 사용해 필터링하기 위한 옵션
                - [Delimiter]로 구분 문자를 지정
                - [Evaluation Mode]로 단어의 매치 조건을 변경
    - [Table Column Filter]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160236212.png]]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160236327.png]]
        
        - 칼럼마다 고도의 필터를 설정할 수 있음
        - [Table Column] = 필터 대상의 칼럼을 선택
        - [Filter] = 필터 조건을 선택
        - [Filter Value] = 필터로 사용하는 값을 입력
        - [Add AND condition], [Add OR condition] = AND나 OR 조건 추가
- 검색
    
    ![[images/Ghidra/IMG-Ghidra-20240818160236538.png]]
    
    - [Label History]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160236659.png]]
        
        - 현재 존재하지 않는 라벨 변경 내역을 검색할 수 있음
        - 검색하고 싶은 문자열을 입력해 OK 버튼을 누르면 검색 결과가 표시
        - 아무것도 입력하지 않으면 모든 이력이 표시
        
        ![[images/Ghidra/IMG-Ghidra-20240818160236821.png]]
        
    - [Program Text]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160236952.png]]
        
          
        
        - 함수, 주석, 라벨, 명령, 정의된 데이터의 문자열을 대상으로 검색 가능
        - [Search Type]
            - [Program Database]
                - 현재 표시되어 있지 않은 정보를 검색할 수 있음
                - Listing Display보다 빠르지만 데이터베이스에 등록된 정보만 검색 가능
            - [Listing Display]
                - Listing 창에 표시되는 텍스트를 검색할 수 있음
                - 데이터베이스에 없는 정보도 검색할 수 있으나 Program Database 보다 느림
        - [Fields]
            - 검색 대상으로 하는 필드를 지정
        - [Memory Blocks Types]
            - 검색 대상으로 하는 메모리 블록을 지정
            - [Loaded Block] = 프로그램으로 실제 로드되는 영역의 메모리
            - [All Blocks] = [OTHER]를 포함한 모든 영역을 대상으로 검색
                - 기드라는 파일 헤더로부터 얻을 수 있는 외부 정보를 [OTHER] 메모리 블록에 저장
        - [Options]
            - [Case Sensitive] = 대소문자 구별
            - [Search Selection] = 선택 영역 검색
    - [Repeat Text Search]
        - [Program Text]에서 검색한 설정을 사용해 재검색
    - [Memory]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160237120.png]]
        
        - 프로그램 내의 바이트 시퀀스를 16진수, 10진수, 문자열로 검색
        - 와일드카드를 포함할 수 있으며 문자열 검색에서는 정규 표현 검색도 사용 가능
        - [Search Value]
            - 검색하고 싶은 값을 입력
        - [Hex Sequence]
            - 그 값을 16진수로 나타낸 값이 표시
        - [Format]
            - 입력한 값을 어떠한 포맷으로 분석할지 설정
            - [String], [Decimal]일 때만 설정 가능
        - [Memory Block Types]
            - 검색 대상으로 하는 메모리 블록을 지정
            - [Loaded Block] = 프로그램으로 실제 로드되는 영역의 메모리
            - [All Blocks] = [OTHER]를 포함한 모든 영역을 대상으로 검색
                - 기드라는 파일 헤더로부터 얻을 수 있는 외부 정보를 [OTHER] 메모리 블록에 저장
        - [Selection Scope]
            - 선택한 범위만 검색 대상으로 설정 가능
        - [Advanced]
            
            ![[images/Ghidra/IMG-Ghidra-20240818160237255.png]]
            
            - 고급 설정이 가능
            - [Byte Order] = [Hex]나 [Decimal]일 때 변경 가능
            - [Code Unit Scope] = 검색 대상 범위 설정 가능
                - [Instructions](명령), [Defined Data](정의된 데이터), [Undefined Data](미정의 데이터)
            - [Alignment] = 지정된 바이트 얼라인먼트의 주소로 시작되는 결과만을 검색하도록 지정
    - [Repeat Memory]
        - [Memory]로 검색한 설정을 이용해 재검색
        - [Selection Scope]는 [Search All]을 선택한 결과와 같음
    - [For Matching Instructions]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160237368.png]]
        
        - 사용하기 위해서는 대상이 되는 범위를 선택해야 함
        - [Exclude Operands] = 오퍼랜드를 마스크하여 오퍼랜드를 포함하지 않는 패턴을 생성하여 검색
        - [Include Operands] = 오퍼랜드를 포함해 선택한 명령과 같은 바이트 열로 검색
        - [Include Operands] (except constants) = 오퍼랜드는 포함되지만 정수는 와일드카드로 마스크
    - [For Address Tables]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160237481.png]]
        
        - Address Tables를 검색해 리스트를 표시
            - [Location], [Label], [Data], [Length]가 표시
        - 검색 대상을 [Search Options]로 설정 가능
            - [Search Selection] = 선택 영역을 범위로 설정
            - [Minimum Length] = 최소 길이 지정
            - [Skip Length] = 스팁하는 바이트 수를 지정
            - [Alignment] = 지정된 바이트 얼라인먼트의 주소로 시작되는 결과만을 검색
    - [For Direct References]
        - 현재 커서 위치 혹은 선택 범위의 주소를 직접 참조하는 주소를 검색
    - [For Instruction Patterns]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160237592.png]]
        
        - 선택한 프로그램 특정 범위의 명령을 다양한 패턴으로 마스크 하여 검색 가능
        - [Instruction Table]
            - 어셈블리어 오퍼랜드가 표시되는 영역
            - 요소마다 블록이 나누어져 있으며 클릭하면 대응하는 바이트가 마스크됨
        - [Search Strings Preview]
            - 해당 창에 대응하는 hex 코드를 표시
        - [Selection Scope]
            - 검색 대상의 범위를 변경
        - [Search Direction]
            - 검색 방향을 변경
        - 상단 버튼
            
            ![[images/Ghidra/IMG-Ghidra-20240818160237706.png]]
            
            - 모든 마스크 제거
            - 명령이 아닌 모든 데이터를 마스크
            - 모든 오퍼랜드를 마스크
            - 모든 스칼라를 마스크
            - 모든 주소를 마스크
            - 목록 창에서 선택 중인 바이트를 로드
            - 검색,마스크할 바이트를 수동으로 입력
            - Instruction Table의 장소로 이동
    - [For Scalars]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160237814.png]]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160237925.png]]
        
        - 프로그램 내 수치를 검색하여 보여줌
            - [Location], [Preview], [Hex], [Decimal], [Function Name]이 표시됨
        - [Search Type]
            - [Scalars in Range] = Scalar의 범위 지정
            - [Specific Scalar] = Scalar의 특정 값을 지정
        - [Selection Scope]
            - 검색 대상의 범위 설정
    - [For Strings]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160238064.png]]
        
        ![[images/Ghidra/IMG-Ghidra-20240818160238232.png]]
        
        - 프로그램 내 문자열 검색
            - [Defined](문자열의 정의 형태), [Location], [Lable], [Code Unit](해당 주소의 코드),
                
                [String View], [String Type], [Length], [Is Word](빈출 단어인지)가 표시됨
                
        - [Require Null Termination]
            - 문자열 끝을 NULL로 지정하는 문자열 검색
        - [Pascal Strings]
            - Pascal 문자열을 검색
        - [Minimum Length]
            - 최소 문자열 길이
        - [Alignment]
            - 지정된 바이트 얼라인먼트의 주소로 시작하는 결과만을 검색
        - [Word Model]
            - 빈출도가 높은 단어인지 판단할 때 필요한 사전 파일을 지정
        - [Memory Block Types]
            - 검색 대상의 메모리를 지정
        - [Selection Scope]
            - 검색 범위를 지정
        - [Defined] 필터 버튼
            
            ![[images/Ghidra/IMG-Ghidra-20240818160238352.png]]
            
            - 정의된 문자열 필터
            - 정의되지 않은 문자열 필터
            - 부분적으로 정의된 문자열 필터
            - 명령 및 데이터와 시작 주소가 충돌하는 문자열 필터
            - 사전에 등록된 단어 필터
- Select
    
    ![[images/Ghidra/IMG-Ghidra-20240818160238527.png]]
    
    - [Program Changes] = 프로그램의 변경된 영역을 모두 선택
    - [All Flows From] = 현재 커서 위치 또는 선택한 코드 유닛의 모든 흐름을 선택
    - [All Flows To] = 현재 커서 위치 또는 선택한 코드 유닛까지 모든 흐름을 선택
    - [Limited Flows From] = 현재 커서 위치 혹은 선택한 코드 유닛으로부터의 흐름을 [Tool Options…]의 [Selection by Flow]에 따라 선택
    - [Limited Flows To] = 현재 커서 위치 혹은 선택한 코드 유닛까지의 흐름을 [Tool Options…]의 [Selection by Flow]에 따라 선택
    - [Subroutine] = 현태 커서 위치 또는 선택 범위를 포함하는 서브 루틴의 모든 범위를 선택
    - [Subroutines Dead] = 직접 참조되지 않은 모든 서브 루틴을 선택
    - [Function] = 현재 커서 위치 또는 선택 범위를 포함하는 함수의 전체 범위를 선택
    - [From Highlight] = 강조 표시의 모든 범위를 선택
    - [Program Highlight] = 강조 표시 범위의 추가나 삭제 등 조작
    - [Scoped Flow]
        - 현재 주소를 포함한 기본 블록으로부터 도달하는 주소를 선택하는 [Forward Scoped Flow]
        - 현재 주소를 포함한 기본 블록을 통과하는 주소를 선택하는 [Reverse Scoped Flow]
    - [Bytes…] = 설정한 방법으로 지정한 바이트 수를 선택
    - [All in View] = 모든 범위를 선택
    - [Clear Selection] = 선택을 클리어
    - [Complement] = 현재 선택 중인 범위 이외의 모든 것을 선택
    - [Data] = 현재 프로그램의 모든 데이터 선택(이미 범위를 선택한 경우 선택 범위 내에서)
    - [Instructions] = 현재 프로그램의 모든 명령 선택(이미 범위를 선택한 경우 선택 범위 내에서)
    - [Undefined] = 현재 프로그램의 모든 미정의 데이터 선택(이미 범위를 선택한 경우 선택 범위 내에서)
    - [Create Table From Selection] = 선택한 영역을 테이블로 보여줌
    - [Restore Selection] = 전에 선택했던 영역을 다시 선택
    - [Forward Refs] = 현재 주소가 참조하고 있는 모든 주소를 선택
    - [Back Refs] = 현재 주소를 참조하는 모든 주소를 선택

# ✅GhidraScript - Eclipse로 jython 설정

- Eclipse 다운로드 - jdk 17 이상이 필요
    
    > [!info] The Community for Open Innovation and Collaboration | The Eclipse Foundation  
    > The Eclipse Foundation provides our global community of individuals and organizations with a mature, scalable, and business-friendly environment for open source …  
    > [https://www.eclipse.org/](https://www.eclipse.org/)  
    
- Jython 다운로드
    
    - Jython(글 작성 시 2.7.3)의 경우, python2만 지원
    
    > [!info] Home  
    > The Python runtime on the JVM  
    > [https://www.jython.org/](https://www.jython.org/)  
    
- PyDev 다운로드
    
    > [!info] PyDev  
    > PyDev Manual  
    > [https://www.pydev.org/index.html](https://www.pydev.org/index.html)  
    
    - 여기서 주의해야할 것이 jython의 경우, python2만 지원
    
    ![[images/Ghidra/IMG-Ghidra-20240818160238652.png]]
    
    - PyDev 최신 버젼의 경우, python2를 지원하지 않으므로 order 버전을 설치해야 함